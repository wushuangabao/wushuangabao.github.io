window.__require=function t(e,i,s){function a(h,o){if(!i[h]){if(!e[h]){var n=h.split("/");if(n=n[n.length-1],!e[n]){var l="function"==typeof __require&&__require;if(!o&&l)return l(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+h+"'")}h=n}var c=i[h]={exports:{}};e[h][0].call(c.exports,function(t){return a(e[h][1][t]||t)},c,c.exports,t,e,i,s)}return i[h].exports}for(var r="function"==typeof __require&&__require,h=0;h<s.length;h++)a(s[h]);return a}({Game:[function(t,e,i){"use strict";cc._RF.push(e,"0bbd32V7flJwaJYRS4aWBJ5","Game"),cc.Class({extends:cc.Component,properties:{overLabel:{default:null,type:cc.Label},lastChessTag:{default:null,type:cc.Node},chessPrefabA:{default:null,type:cc.Prefab},chessPrefabB:{default:null,type:cc.Prefab},nullSpriteFrameB:{default:null,type:cc.SpriteFrame},nullSpriteFrameA:{default:null,type:cc.SpriteFrame},redSpriteFrameB:{default:null,type:cc.SpriteFrame},redSpriteFrameA:{default:null,type:cc.SpriteFrame},blueSpriteFrameA:{default:null,type:cc.SpriteFrame},blueSpriteFrameB:{default:null,type:cc.SpriteFrame},UI1:{default:null,type:cc.Node},danji:{default:!0,displayName:"\u662f\u5426\u5355\u673a"},touchChess:{default:null,type:cc.Node,visible:!1},audioButton:{type:cc.AudioSource,default:null},audioChessDown:{type:cc.AudioSource,default:null},audioChessDead:{type:cc.AudioSource,default:null},audioGameOver:{type:cc.AudioSource,default:null},dBorderX:{default:30},dBorderY:{default:10},w:{default:30,displayName:"\u5c0f\u516d\u8fb9\u5f62\u7684\u8fb9\u957f"}},initializeParams:function(){this.strOver="",this.seconds=0,this.size=13,this.maxY=18,this.maxX=27,this.overLabel.string="",this.labelDaoJiShi.string=""+this.daojishi,this.UiDaoJiShi.color=new cc.Color(0,125,255),this.jie={red:null,blue:null,tag:0},this.ting={red:!1,blue:!1},this.gameState="blue",this.recordList=[],this.recordDead=[],this.recordJie=[]},resize:function(){var t=cc.find("Canvas").getComponent(cc.Canvas);this.curDR=cc.view.getFrameSize();var e,i,s=this.curDR,a=s.width,r=s.height;console.log("view size: ",a,r),a/r>.25*Math.sqrt(3)?(e=(i=s.height)*a/r,this.w0=i):(i=r/a*(e=s.width),this.w0=e),console.log("w0 = ",this.w0),t.designResolution=cc.size(e,i),this.curDR=t.designResolution},leftOf:function(t,e,i){var s,a=t.tagNum;if(352==a)return this.chessList[324];if(109==a)return this.chessList[135];if(!e||!i)e=a%this.maxX,i=Math.floor(a/this.maxX);return"A"==t.tagType?1==t.tagBorder?s=this.chessList[i*this.maxX-this.maxX+e-2]:2==t.tagBorder&&(s=this.chessList[i*this.maxX+this.maxX+e]):"B"==t.tagType&&(2==t.tagBorder?s=this.chessList[i*this.maxX-this.maxX+e]:3==t.tagBorder&&(s=this.chessList[i*this.maxX+this.maxX+e-2])),void 0===s&&(s=this.chessList[a-1]),"midX"===s?this.chessList[a-2]:s},rightOf:function(t,e,i){var s,a=t.tagNum;if(376==a)return this.chessList[350];if(133==a)return this.chessList[161];if(!e||!i)e=a%this.maxX,i=Math.floor(a/this.maxX);return"A"==t.tagType?5==t.tagBorder?s=this.chessList[i*this.maxX+this.maxX+e]:6==t.tagBorder&&(s=this.chessList[i*this.maxX-this.maxX+e+2]):"B"==t.tagType&&(4==t.tagBorder?s=this.chessList[i*this.maxX+this.maxX+e+2]:5==t.tagBorder&&(s=this.chessList[i*this.maxX-this.maxX+e])),void 0===s&&(s=this.chessList[a+1]),"midX"===s?this.chessList[a+2]:s},upDownOf:function(t,e,i){var s,a=t.tagNum;if(!e||!i)e=a%this.maxX,i=Math.floor(a/this.maxX);return 324==a?this.chessList[352]:135==a?this.chessList[109]:350==a?this.chessList[376]:161==a?this.chessList[133]:("A"==t.tagType?s=3==t.tagBorder?this.chessList[i*this.maxX-this.maxX+e+2]:4==t.tagBorder?this.chessList[i*this.maxX-this.maxX+e-2]:this.chessList[i*this.maxX-this.maxX+e]:"B"==t.tagType&&(s=1==t.tagBorder?this.chessList[i*this.maxX+this.maxX+e+2]:6==t.tagBorder?this.chessList[i*this.maxX+this.maxX+e-2]:this.chessList[i*this.maxX+this.maxX+e]),s)},isInBoard:function(t,e,i){var s=!1;if(this.tagBorder=0,e<=4){var a=12-3*e,r=14+3*e;t>=a&&t<=r&&(!0===i&&(t==a||t==a+1?this.tagBorder=3:t!=r&&t!=r-1||(this.tagBorder=4)),s=!0)}else if(e>=13){var h=3*e-39,o=65-3*e;t>=h&&t<=o&&(!0===i&&(t==h||t==h+1?this.tagBorder=1:t!=o&&t!=o-1||(this.tagBorder=6)),s=!0)}else s=!0;return 0!=e&&17!=e||13!=t?0!=t||13!=e&&4!=e?26!=t||13!=e&&4!=e?(s||!0!==i||this.chessList.push(null),s):(!0===i&&this.chessList.push("rightX"),!1):(!0===i&&this.chessList.push("leftX"),!1):(!0===i&&this.chessList.push("midX"),!1)},canPutChess:function(t,e){if(arguments.length>=2)var i=e;else{if("null"!=(i=this.touchChess).tagColor)return!1;this.listTagNum=new Array}var s=i.tagNum,a=i.tagColor,r=this.listTagNum;if(-1==r.indexOf(s)){if(a!=t&&arguments.length>=2)return"null"==a;var h,o,n,l=s%this.maxX,c=Math.floor(s/this.maxX);return r.push(s),h=this.canPutChess(t,this.upDownOf(i,l,c)),o=this.canPutChess(t,this.leftOf(i,l,c)),n=this.canPutChess(t,this.rightOf(i,l,c)),!!(h||o||n)}return!1},judgeDead:function(t,e,i){if(t.tagColor!=e)return"null"==t.tagColor||(this.jie.tag-=2,!1);this.listTagNum=new Array;var s=this.canPutChess(e,t);return!s&&i&&this.removeDead(e),!s},removeDead:function(t){var e=this.listTagNum.length;if(e>0){this.audioChessDead.play();for(var i=0;i<e;i++){var s=this.chessList[this.listTagNum[i]];this.setChess(s,"null")}var a=this.recordList.length,r=this.recordDead.length-1;if(this.recordDead[r]&&this.recordDead[r].id===a)for(i=0;i<e;++i)this.recordDead[r].list.push(this.listTagNum[i]);else this.recordDead.push({id:a,list:this.listTagNum});1==e&&(this.jie.tag+=1,this.jie[t]=this.listTagNum[0])}},setChess:function(t,e){t&&(e?t.tagColor!=e&&(t.tagColor=e):e=t.tagColor,"null"===e?("A"==t.tagType?t.getComponent(cc.Sprite).spriteFrame=this.nullSpriteFrameA:t.getComponent(cc.Sprite).spriteFrame=this.nullSpriteFrameB,t.tagColor=e):"red"===e?"A"==t.tagType?t.getComponent(cc.Sprite).spriteFrame=this.redSpriteFrameA:t.getComponent(cc.Sprite).spriteFrame=this.redSpriteFrameB:"blue"===e&&("A"==t.tagType?t.getComponent(cc.Sprite).spriteFrame=this.blueSpriteFrameA:t.getComponent(cc.Sprite).spriteFrame=this.blueSpriteFrameB))},onTouchChess:function(t){var e=t.currentTarget;if("null"==e.tagColor&&e.tagNum!=this.jie[this.gameState]){var i=this.fanState();e.tagColor=this.gameState;var s=this.judgeDead(this.upDownOf(e),i,!0),a=this.judgeDead(this.leftOf(e),i,!0),r=this.judgeDead(this.rightOf(e),i,!0);s||a||r?(1!=this.jie.tag&&(this.jie[i]=null),this.jie.tag=0,this.putChess(e)):(this.touchChess=e,e.tagColor="null",this.canPutChess(this.gameState)&&this.putChess(e))}},putChess:function(t){this.audioChessDown.play(),t.tagColor=this.gameState,this.setChess(t,this.gameState),this.lastChessTag.setPosition(t.x,t.y),null!=this.jie[this.gameState]&&this.recordJie.push({id:this.recordList.length,tagNum:this.jie[this.gameState],color:this.gameState}),this.recordList.push(t.tagNum),this.changeGameState()},changeGameState:function(){this.jie[this.gameState]=null,"red"==this.gameState?(this.UiDaoJiShi.color=new cc.Color(0,125,255),this.gameState="blue"):(this.UiDaoJiShi.color=new cc.Color(255,25,0),this.gameState="red"),this.ting[this.gameState]&&(this.ting[this.gameState]=!1),this.labelDaoJiShi.string=""+this.daojishi,this.seconds=0},fanState:function(){return"red"==this.gameState?"blue":"red"},ccV2ById:function(t,e,i,s){var a=this.w,r=i||this.dBorderX,h=s||this.dBorderY,o=.5*Math.sqrt(3)*a*t+r,n=1.5*a*e+h;return cc.v2(o,n)},onLoad:function(){this.daojishi=Global.timePerState,this.UiDaoJiShi=this.UI1.getChildByName("DaoJiShi"),this.labelDaoJiShi=this.UiDaoJiShi.getComponent(cc.Label),this.initializeParams(),this.resize();var t=this,e=(Math.sqrt(3),this.w/200),i=this.dBorderX,s=this.dBorderY;this.size,this.w;this.labelDaoJiShi.string=""+this.daojishi,this.chessList=new Array;for(var a=0;a<this.maxY;a++)for(var r=0;r<this.maxX;r++){var h;if(this.isInBoard(r,a,!0))(r+a)%2==0?(h=cc.instantiate(this.chessPrefabB)).tagType="B":(h=cc.instantiate(this.chessPrefabA)).tagType="A",h.setScale(e),this.node.addChild(h),this.chessList.push(h),h.setPosition(this.ccV2ById(r,a,i,s)),h.tagNum=this.maxX*a+r,h.tagColor="null",h.tagBorder=this.tagBorder,0==r?h.tagBorder=2:r==this.maxX-1&&(h.tagBorder=5),h.on(cc.Node.EventType.TOUCH_END,function(e){t.onTouchChess(e)})}},judgeWinner:function(){var t=0,e=0;this.listTagNum=[];for(var i=0;i<this.chessList.length;++i){var s=this.chessList[i];if(s){var a=this.detectEnclosure(s);"red"==a?t++:"blue"==a&&e++}}return this.strOver="\u7ea2"+t+"\u84dd"+e+"\uff0c",t>e?"red":t<e?"blue":void 0},detectEnclosure:function(t){if(-1!=this.listTagNum.indexOf(t.tagNum))return!1;if("null"==t.tagColor){13==t.tagNum&&console.log(13),this.listTagNum.push(t.tagNum);var e=this.detectEnclosure(this.upDownOf(t));if("red"==e||"blue"==e)if(e==this.detectEnclosure(this.leftOf(t))&&this.detectEnclosure(this.rightOf(t))==e)return e;return"null"}return"red"==t.tagColor?"red":"blue"==t.tagColor?"blue":void 0},resetJie:function(t){var e=this.recordJie.length-1;if(!(e<0)){var i=this.recordJie[e];i.id==t&&(this.recordJie.pop(),this.jie[i.color]=i.tagNum)}},resetDead:function(t){var e=this.recordDead.length-1;if(!(e<0)){var i=this.recordDead[e];if(i.id==t){if(this.recordDead.pop(),t%2==0)var s="red";else s="blue";for(var a=0;a<i.list.length;++a){var r=this.chessList[i.list[a]];r.tagColor=s,this.setChess(r)}}}},huiqi:function(){if(this.audioButton.play(),this.lastChessTag.setPosition(1e3,0),this.danji){var t=this.recordList.pop();if(void 0===t)return;var e=this.chessList[t],i=this.recordList.length;e.tagColor="null",this.setChess(e,"null"),this.resetJie(i),this.resetDead(i),this.changeGameState()}else this.overLabel.string=this.getColorHanZi(this.gameState)+"\u8bf7\u6c42\u6094\u68cb",this.tagOverLabel=2},renshu:function(){this.strOver=this.getColorHanZi(this.gameState)+"\u8ba4\u8f93\uff0c",this.gameOver(this.fanState())},tingyishou:function(){this.audioButton.play(),this.ting[this.gameState]=!0,this.overLabel.string=this.getColorHanZi(this.gameState)+"\u505c\u4e00\u624b",this.tagOverLabel=2,this.ting[this.fanState()]?this.gameOver(this.judgeWinner()):this.changeGameState()},getColorHanZi:function(t){return"red"==t?"\u7ea2\u65b9":"blue"==t?"\u84dd\u65b9":"null"},gameOver:function(t){if(!t)t=this.judgeWinner();this.audioGameOver.play();var e=this.getColorHanZi(t);this.overLabel.string="null"==e?this.strOver+"\u53cc\u65b9\u5e73\u5c40":this.strOver+e+"\u83b7\u80dc",this.tagOverLabel=30,this.labelDaoJiShi.string=""},restart:function(){cc.director.loadScene("menu")},update:function(t){if(""!=this.labelDaoJiShi.string&&(this.seconds+=t),this.seconds>=1){this.seconds=0;var e=Number(this.labelDaoJiShi.string)-1;e<0?(this.labelDaoJiShi.string=""+this.daojishi,this.strOver=this.getColorHanZi(this.gameState)+"\u8d85\u65f6\uff0c",this.gameOver(this.fanState())):this.labelDaoJiShi.string=""+e,this.tagOverLabel&&(this.tagOverLabel-=1,this.tagOverLabel<=0&&(this.overLabel.string="",this.strOver=""))}}}),cc._RF.pop()},{}],Menu:[function(t,e,i){"use strict";cc._RF.push(e,"ddbfa69KBhNn6ZpB0CRXqv7","Menu"),window.Global={timePerState:60},cc.Class({extends:cc.Component,properties:{},startGame:function(t,e){Global.timePerState=e,cc.director.loadScene("game")}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e,i){"use strict";cc._RF.push(e,"42a14A9VK1O0Ytfqzi6hdLQ","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}]},{},["use_v2.0.x_cc.Toggle_event","Game","Menu"]);